<h2>Log In</h2>

<% if params[:handle] %>
 To log in as <%= @handle.name %>, sign the session claim:
 <pre><code><%= @claim %></code></pre>
<h3>Signing Instructions</h3>
 <pre><code>echo "<%= @handle.name %>:<%= @session_secret %>" > /tmp/claim.txt
minisign -Sm /tmp/claim.txt</code></pre>
<h3>Upload</h3>
<pre><code>curl -F "signature=@/tmp/claim.txt.minisig" \
     -F "claim=@/tmp/claim.txt" \
     -F "handle=<%= @handle.name%>" \
     <%= proofs_url %></code></pre>

<%= form_tag session_path do %>
    <%= hidden_field :session, :claim, value: @claim %>
    <%= submit_tag :"I did this" %>
<% end %>
<% else %>
  <%= form_tag new_session_path, method: 'GET' do %>
    <%= label_tag :handle %>:
    <%= text_field_tag :handle %>
    <%= submit_tag "Log In" %>
  <% end %>
<% end %>
